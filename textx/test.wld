place Room1 {
    """
        name: Room1
        description: You are in room One
    """

    objects {
        apple
    }
}

place Room2 {
    """
        name: Room2
        description: You are in room Two, entrance to the room Four is blocked by door  
    """

    objects {}

    blockade {
        is_door_opened, N
    }
}

place Room3 {
    """
        name: Room3
        description: You are in room Three
    """
    
    objects {
        chest
    }
}

place Room4 {
    """
        name: Room4
        description: You are in room Four
    """

    objects {}
}

object_defs {
    object apple {
        """
            name: an apple
            description: Big green apple
        """
        pickable: true
        container: Room1
    }
    object chest {
        """
            name: small chest
            description: Small chest for jewelery
        """

        objects {
            gold_key
        }
        pickable: false
        container: Room3
    }
    object gold_key {
        """
            name: gold key
            description: Golden key that has cross on it
        """
        pickable: true
        container: chest
    }
    object seeds {
        """
            name: apple seeds
            description: Seeds from fresh apple
        """
        pickable: true
    }
}

connections {
    Room1, N, Room2
    Room2, W, Room3
    Room2, N, Room4
}

command_defs {
    command "examine chest" {
        is_present: [chest]
        move: gold_key
        success: "You have found golden key."
        fail: ""
        flag: examined_chest == false
    }
    command "examine" {
        message: "Nothing catches your eye."
    }
    command "open door" {
        flag: is_door_opened == false
        success: ""
        fail: "It's locked."
        at: Room2
    }
    command "close door" {
        flag: is_door_opened == true
        success: ""
        fail: "Door is already closed."
        at: Room2
    }
    command "unlock door" {
        flag: is_door_unlocked == false
        success: "You have unlocked the door."
        fail: "You don't have key to unlock it."
        is_carried: [gold_key]
        at: Room2
    }
    command "lock door" {
        flag: is_door_unlocked == true
        success: "You have locked the door."
        fail: "I can't do it."
        is_carried: [gold_key]
        at: Room2
    }
    command "extract seeds", "derivate seeds", "break apple" {
        is_carried: [apple]
        create: seeds
        delete: apple
        success: "You have extract seeds from apple."
        fail: "From what?"
    }
}

flags {
    flag is_door_unlocked {
        activated: false
        action_on_true: {
            message: "Door is already unlocked."
        }
        action_on_false: {
            message: "Door is already locked."
            dependencies: [is_door_unlocked == true, is_door_opened == false]
        }
    }
    flag is_door_opened {
        activated: false
        action_on_true: {
            message: "Door is already open."
            dependencies: [is_door_unlocked == true]
        }
        action_on_false: {
            message: "Door is already closed."
        }
    }
    flag examined_chest {
        activated: false
        action_on_true: {
            message: "Nothing cathes your eye."
        }
        action_on_false: {}
    }
}

player {
    name: Player1
    position: Room1
    inventory {}
}

finish {
    position: Room4
}